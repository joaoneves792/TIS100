@0
MOV 0, LEFT
L:MOV UP, ACC
JEZ E
MOV ACC, LEFT
JMP L
E:MOV 0, RIGHT
MOV NIL, DOWN
MOV DOWN, NIL

@1
S:MOV RIGHT, NIL
L:MOV UP, ACC
MOV ACC, DOWN
JEZ E
MOV RIGHT, ACC
SUB DOWN
JGZ I
P:MOV DOWN, RIGHT
JMP L
I:MOV -1, RIGHT
MOV RIGHT, UP
MOV DOWN, UP
JMP L
E:MOV RIGHT, NIL
MOV DOWN, RIGHT

@2
MOV UP, LEFT
L:MOV RIGHT, LEFT
MOV LEFT, ACC
MOV ACC, RIGHT
JEZ E
JLZ R
MOV ACC, RIGHT
JMP L
R:MOV RIGHT, LEFT
JMP L
E:MOV ACC, DOWN
MOV DOWN, ACC
JGZ E
MOV DOWN, UP

@3
L:MOV UP, ACC
MOV ACC, UP
MOV ACC, LEFT
MOV LEFT, ACC
JEZ E
JLZ R
MOV LEFT, UP
JMP L
R:MOV UP, LEFT
JMP L
E:MOV UP, ACC
MOV ACC, DOWN
MOV ACC, DOWN
JGZ E
!MOV 0, DOWN

@4
L:MOV UP, ACC
MOV ACC, UP
JEZ E
MOV ACC, UP
JMP L
E:SUB 999
MOV ACC, RIGHT
MOV ACC, RIGHT
MOV RIGHT, ACC
JGZ E

@5
S:MOV RIGHT, ACC
MOV ACC, UP
JEZ E
L:ADD RIGHT
JGZ L
SUB LEFT
JGZ N
MOV LEFT, LEFT
MOV UP, NIL
JMP S
N:MOV LEFT, NIL
MOV ACC, LEFT
JMP S
E:MOV UP, DOWN

@6
S:MOV UP, ACC
MOV ACC, LEFT
JEZ E
MOV 1, LEFT
MOV UP, ACC
L:SUB UP
JEZ P1
MOV -999, LEFT
JMP S
P1:MOV 1, LEFT
ADD UP
JMP L
E:MOV 0, LEFT
