@0
MOV DOWN, RIGHT

@1
S:MOV UP, ACC
SAV
L2:SWP
SAV
L:SUB LEFT
MOV ACC, DOWN
SWP
MOV ACC, DOWN
SWP
MOV DOWN, ACC
JEZ L2
JLZ S
SAV
JMP L

@2
MOV DOWN, ACC
MOV ACC, DOWN
MOV ACC, DOWN

@3
S:MOV RIGHT, ACC
MOV ACC, DOWN
L:SWP
ADD DOWN
SWP
SUB 1
JEZ E
MOV DOWN, DOWN
JMP L
E:MOV DOWN, NIL
SWP
MOV ACC, UP
JMP S

@4
MOV 2, ACC
L:SAV
MOV ACC, LEFT
MOV UP, ACC
MOV UP, RIGHT
JLZ E
SWP
MOV ACC, RIGHT
MOV ACC, DOWN
MOV DOWN, UP
ADD DOWN
JMP L
E:MOV 1, RIGHT
MOV -1, DOWN
MOV -1, UP

@5
S:MOV LEFT, ACC
MOV LEFT, UP
L:SUB UP
JGZ C
JEZ E
ADD UP
MOV 0, RIGHT
JMP X
C:MOV UP, UP
MOV 1, RIGHT
JMP L
E:MOV UP, RIGHT
MOV 0, RIGHT
X:MOV ACC, DOWN
MOV RIGHT, DOWN

@6
L:MOV LEFT, ACC
JEZ E
SWP
ADD 1
SWP
JMP L
E:SWP
MOV ACC, LEFT
MOV 0, ACC
SAV

@7
MOV UP, ACC
MOV ACC, UP
MOV ACC, UP

@8
S:MOV RIGHT, ACC
JNZ E
MOV UP, ACC
JLZ R
MOV ACC, DOWN
MOV RIGHT, UP
MOV 0, UP
JMP S
E:MOV UP, NIL
MOV RIGHT, NIL
MOV 0, UP
MOV 1, UP
JMP S
R:MOV RIGHT, DOWN
MOV 0, DOWN

@9
MOV UP, LEFT

@10

